<style>
    label .titlebold {
        font-size: 14px;
        font-family: bold !important;
    }
    #scrollable-dropdown-menu .dropdown-menu {
			max-height: 300px;
			overflow-y: auto;
		}

    .recipient .popover {
        max-width: 600px;
    }

    .recipient .popover-content {
        padding: 2px;
        padding-bottom: 0px;
    }
</style>
<div ng-controller="ScheduledReportController">    
    <div class="table table-responsive"  style = "overflow-x:hidden;height: 800px;">
        <table  st-table="guestlist" st-pipe="getDataList" class="table ticket table-striped b-t b-light">
            <thead class="tblhead-sm">
            <tr>
                <th st-sort="name">Schedule Name</th>
                <th st-sort="frequency">Frequency</th>
                <th>Format</th>
                <th>Details</th>
                <th>Recipient</th>
                <th>Action</th>
            </tr>
            </thead>
            <tbody ng-hide="isLoading">
                <tr class="" ng-repeat="row in datalist"  >
                    <td class="col-md-2">
                        <button class="btn btn-xs" ng-if="row.sel == true" style="margin-right:5px; padding: 8px;background: #f05050" data-title="Selected">
                        </button>
                        <i class="fa fa-pencil" aria-hidden="true"  ng-click="onFieldHidden('name',row)"></i>
                        <label ng-show="row.label" class="reportlabel">{{row.name}}</label>
                        <input ng-show="row.input" type="text" size="4" class="reportinput" ng-model="row.name" ng-keyup="$event.keyCode == 13 && onKeySave('name',row)"    />
                    </td>
                    <td class="col-md-2">
                        {{row.frequency}}
                    </td>
                    <td class="col-md-1">
                        <select class="form-control input-sm" ng-model="row.format" ng-change="onChangeFormat(row)"
                            ng-options="value for value in format_list">		
                        </select>                        
                    </td>
                    <td class="col-md-3 reportdetail" >
                        <a href uib-popover-template="'reportdeatil.html'" popover-trigger="outsideClick"  popover-placement="bottom-right" ng-click="onClickSchedule(row)">
                            <i class="fa fa-pencil" aria-hidden="true"  ></i>
                            <span> {{applyDetail(row)}} </span>
                        </a>
                    </td>
                    <td class="col-md-2 recipient">
                        <a href uib-popover-template="'recipient.html'" popover-placement="bottom-right" popover-is-open="row.recipient_flag" ng-click="onClickRecipient(row)">
                            <i class="fa fa-pencil" aria-hidden="true"  ></i>
                            <span> {{row.recipient}} </span>
                        </a>
                    </td>
                    <td class="col-md-1">
                        <button class="btn btn-danger btn-xs " style="margin-left: 10px;" data-title="Delete" data-toggle="modal" data-target="#deleteModal" ng-click="onDelete(row)">
                            <span class="glyphicon glyphicon-trash"></span>
                        </button>
                    </td>
                </tr>
            </tbody>
            <tbody ng-show="isLoading">
                <tr>
                    <td colspan="5" class="text-center"><i class="fa fa-spin fa-refresh"></i></td>
                </tr>
            </tbody>
            <tfoot ng-hide="isLoading">
            <tr ng-show="paginationOptions.totalItems > paginationOptions.pageSize">
                <td colspan="5" class="text-center">
                    <div st-pagination="" st-items-by-page="paginationOptions.pageSize" st-displayed-pages="7" class="no-margin"></div>
                </td>
            </tr>
            </tfoot>
        </table>
    </div>    
</div>

<!--drag dialg for detail inforamtion-->
<script type="text/ng-template" id="reportdeatil.html"  >
    <div class="panel panel-default"  style="width: 500px;margin-bottom: 0px;">
        <div class="panel-body">
            <form class="form-horizontal form-validation" >
                <div class="form-group">
                    <label class="col-sm-3 control-label">Frequency {{schedule.frequency}}</label>
                    <div class="col-sm-9">
                        <div class="btn-group">
                            <label class="btn btn-info btn-sm" ng-model="schedule.frequency" uib-btn-radio="'Daily'" >Daily</label>
                            <label class="btn btn-info btn-sm" ng-model="schedule.frequency" uib-btn-radio="'Hourly'">Hourly</label>
                            <label class="btn btn-info btn-sm" ng-model="schedule.frequency" uib-btn-radio="'Weekly'">Weekly</label>
                            <label class="btn btn-info btn-sm" ng-model="schedule.frequency" uib-btn-radio="'Monthly'">Monthly</label>
                            <label class="btn btn-info btn-sm" ng-model="schedule.frequency" uib-btn-radio="'Custom Days'">Custom Days</label>
                        </div>
                    </div>
                </div>
                <div class="form-group" ng-hide="schedule.frequency == 'Daily' ||schedule.frequency == 'Weekly' ">
                    <label class="col-sm-3 control-label">Date</label>
                    <div class="col-sm-9">
                        <div class="input-group" style="width: 300px">
                            <input type="text" required class="form-control" uib-datepicker-popup="yyyy-MM-dd" ng-model="schedule.date" is-open="schedule.opened" date-disabled="disabled(date, mode)" datepicker-options="dateOptions" ng-required="true" close-text="Close" />
                            <span class="input-group-btn">
                                <button type="button" class="btn btn-default btn-sm" ng-click="open($event)"><i class="glyphicon glyphicon-calendar"></i></button>
                            </span>
                        </div>
                    </div>
                </div>
                <div class="form-group" ng-hide="schedule.frequency == 'Daily' || schedule.frequency == 'Monthly' || schedule.frequency == 'Custom Days'  ">
                    <label class="col-sm-3 control-label">Day</label>
                    <div class="col-sm-9">
                        <select class="input-sm" ng-model="schedule.sel_day" ng-change="onChangeAction(task.action)" ng-options="day for day in days">
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">Time</label>
                    <div class="col-sm-9">
                        <input type="time" required ng-model="schedule.time" style="width: 200px" class="form-control input-sm">
                    </div>
                </div>

                <div class="form-group" ng-show="schedule.frequency == 'Custom Days'">
                    <label class="col-sm-3 control-label">Repeat Schedule</label>
                    <div class="col-sm-9">
                        <label class="i-switch m-t-xs m-r">
                            <input type="checkbox" ng-model="schedule.repeat" checked>
                            <i></i>
                        </label>
                    </div>
                </div>

                <div class="form-group" ng-show="schedule.frequency == 'Custom Days'">
                    <label class="col-sm-3 control-label text-muted">Frequency</label>
                    <div class="col-sm-5">
                        <input class="form-control input-sm" type="number" data-ng-model="schedule.interval"
                                />
                    </div>
                    <div class="col-sm-4">
                        <select class='form-control input-sm' ng-model="schedule.freq_unit"
                                ng-options="value for value in frequency_units" >
                        </select>
                    </div>
                </div>

                <div class="line line-dashed b-b line-lg pull-in"></div>
                <div class="form-group">
                    <div class="pull-right" style="margin-right: 20px">
                        <button type="button" class="btn btn-primary" ng-click="onSaveSchedule()">&nbsp;&nbsp;&nbsp;&nbsp;Save&nbsp;&nbsp;&nbsp;&nbsp;</button>
                        <button type="button" class="btn btn-default" ng-click="detailDisplay=false">Cancel</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</script>

<script type="text/ng-template" id="recipient.html"  >
    <div class="panel panel-default"  style="width: 500px;margin-bottom: 0px;">
        <div class="panel-body">
            <form class="form-horizontal form-validation" >
                <div class="form-group">
                    <label class="col-sm-3 control-label">Recipients</label>
                    <div class="col-sm-9">
                        <tags-input ng-model="schedule.recipient"
                                    style="margin-top: -5px"
                                    placeholder="Email"                                    
                                    replace-spaces-with-dashes="false"  >
                                    <auto-complete source="emailFilter($query)"
                                                    min-length="0"
                                                    load-on-focus="true"
                                                    load-on-empty="true"
                                                    debounce-delay="0"
                                                    max-results="10"
                                                    >
                                    </auto-complete>
                            </tags-input>
                    </div>
                </div>
                <div class="line line-dashed b-b line-lg pull-in"></div>
                <div class="form-group">
                    <div class="pull-right" style="margin-right: 20px">
                        <button type="button" class="btn btn-primary" ng-click="onSaveRecipient()">&nbsp;&nbsp;&nbsp;&nbsp;Save&nbsp;&nbsp;&nbsp;&nbsp;</button>
                        <button type="button" class="btn btn-default" ng-click="onCancelRecipient()">Cancel</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

</script>