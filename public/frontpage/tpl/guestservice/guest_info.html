<style>
	thead, tbody tr {
		display:table;
		width:100%;
		table-layout:fixed;
	}
    .app-modal-window .modal-dialog {
        width: 850px;
    }
    .custom-modal-window .modal-dialog {
      width: calc(100% - 60px);
    }
</style>
<div ng-controller="GuestinfoController" style="overflow-x: hidden">
    <script type="text/ng-template" id="guest_detail.html">
        <div ng-include="'tpl/guestservice/modal/guest_detail.html'"></div>
    </script>
    <script type="text/ng-template" id="confirm_modal.html">
        <div ng-include="'tpl/modal/modal_confirm.html'"></div>
    </script>
    <script type="text/ng-template" id="guest_logs.html">
        <div ng-include="'tpl/guestservice/modal/guest_logs.html'"></div>
    </script>
	
    <div class="form-horizontal col-md-12 wrapper" style="display: table; background-color: #141414">
	    
		<div class="row col-md-3" style="">
			<h3 class="m-n font-thin" style="white-space: nowrap; color: #337ab7"> <i class="icon-user"></i> Guest Information</h3>
		</div>
		
		<div class="input-group col-md-2 pull-right">
	      <input type="text" ng-model="searchtext" ng-keypress="($event.which === 13) ? onSearch() : 0" class="form-control input-sm bg-light no-border  padder" placeholder="Search">
	      <span class="input-group-btn">
	        <button type="submit" class="btn btn-sm bg-light "><i class="fa fa-search"></i></button>
	      </span>
	    </div>
		<div class="row col-sm-2" ng-show="auth_svc.isValidModule('app.guestservice.facilities')">
		<button ng-if="auth_svc.isValidModule('app.guestservice.facilities')" class="btn btn-sm btn-icon bg-all " data-toggle="tooltip" title="Show All" data-placement="bottom" ng-click="onFilter(1)">
				<i class=""></i><label><b>ALL</b></label>
			</button>
      
      <button ng-if="auth_svc.isValidModule('app.guestservice.facilities')" class="btn btn-sm btn-icon bg-wakeup-success " data-toggle="tooltip" title="Active Facilities" data-placement="bottom" ng-click="onFilter(3)">
								<!-- In-Progress -->
				<i class="fa fa-sign-out fa-fw"></i>
			</button>
	      
      <button  ng-show="auth_svc.isValidModule('app.guestservice.facilities')" id="dateranger" class="btn btn-sm btn-icon btn-dark" data-toggle="tooltip" title="Filter" data-placement="bottom"
        ui-jq="daterangepicker" ui-options="dateRangeOption" data-title="Refresh" ng-click="onDownloadExcel()">
        <i class="fa fa-file-excel-o" style="font-size: 20px; color:green" aria-hidden="true" title="Facilities download"></i>
      </button>
        
		
  </div>	
  <div class="row col-sm-1" >
    <button class="btn btn-sm bg-complaint-ack" data-toggle="dropdown" aria-expanded="false">
      <label style="margin-bottom: 1px">Filter&nbsp;&nbsp;&nbsp;</label>	
      <span class="caret"></span>
    </button>
    <ul class="dropdown-menu w1" aria-labelledby="single-button" data-toggle="dropdown" aria-expanded="false">
      <li ng-click="onFilter('Total')">
        <a href=""><label>All</label></a>
      </li>
      <li ng-click="onFilter(1)">
        <a href=""><label>Check IN</label></a>
      </li>
      <li ng-click="onFilter(2)">
        <a href=""><label>Check Out</label></a>
      </li>
    </ul>
  </div>	
	  
		<div class="row col-sm-4" style="margin: auto"  ng-hide="mobile_flag">
			<button class="btn btn-sm btn-success pull-right" ng-if="auth_svc.isValidModule('access.guestservice.swapdatabase')" data-ng-click="onSwapDatabase()">
				<i class="fa fa-exchange" style="margin: auto;"></i>&nbsp;&nbsp;DB Swap&nbsp;
			</button>
			
			<button class="btn btn-sm btn-primary pull-right" data-ng-click="onShowManualPosting()" ng-if="auth_svc.isValidModule('app.guestservice.manualposting')" style="margin-right: 10px">
				<i class="fa fa-paper-plane" style="margin: auto;"></i>&nbsp;&nbsp;Posting&nbsp;
			</button>
      
    
			<!--<div class="row pull-right" style="padding-left: 2px">
        <div class="row col-md-7" style="margin: auto">
	        <button class="btn btn-sm btn-icon bg-all " data-toggle="tooltip" title="Show All" data-placement="bottom" ng-click="onFilter(1)">
						<i class=""></i><label><b>ALL</b></label>
					</button>
					<button class="btn btn-sm btn-icon bg-wakeup-success " data-toggle="tooltip" title="Active Facilities" data-placement="bottom" ng-click="onFilter(3)">
								
						<i class="fa fa-sign-out fa-fw"></i>
					</button>
				</div>                    
      </div>-->
			
			<!--test-->
    </div>
    <!-- <div class="row col-sm-4" style="margin: auto"  ng-hide="multiple_flag==0">
			
			<button class="btn btn-sm btn-success pull-right" data-toggle="dropdown" aria-expanded="false" ng-if="auth_svc.isValidModule('access.guestservice.swapdatabase')||auth_svc.isValidModule('app.guestservice.manualposting')">
          <label style="margin-bottom: 1px"><i class="fa fa-exchange" style="margin: auto;"></i>&nbsp;&nbsp;DB Swap/Posting&nbsp;</label>	
          <span class="caret"></span>
        </button>
        <ul class="dropdown-menu w1 pull-right" aria-labelledby="single-button" data-toggle="dropdown" aria-expanded="false">
          <li ng-repeat="building in buildings" ng-click="onSelectBuilding(building)">
              <a href=""><label>{{building.name}}</label></a>
            </li>
        </ul>    

        
      
		</div> -->
		  
		<!--
		<label>Filter </label>
		<select class='input-sm' ng-model="checkout_flag" ng-change="onChangeCheckout()"
            ng-options="state for state in checkout_states">
    </select>-->
	</div>
								
    
		<div class="table  table-responsive" additional-padding="40" ng-show="!mobile_flag">
            <table st-table="guestlist"  st-pipe="getGuestList" class="table table-striped ticket">
                <thead class="tblhead-sm">
					<tr>

                        <th class="text-center" st-sort="id" st-sort-default="reverse" style="width: 5%">&nbsp;&nbsp;ID</th>
                        <th class="text-center" st-sort="room" style="width: 6%">&nbsp;&nbsp;Building</th>
												<th class="text-center" st-sort="room" style="width: 6%">&nbsp;&nbsp;Room</th>
												<th class="text-center" st-sort="guest_name" style="width: 12%">&nbsp;&nbsp;Name</th>
                        <th class="text-center" st-sort="guest_id" style="width: 7%">&nbsp;&nbsp;Guest ID</th>
                        <th class="text-center" st-sort="arrival" style="width: 7%">&nbsp;&nbsp;Arrival</th>
												<th class="text-center" st-sort="departure" style="width: 7%">&nbsp;&nbsp;Departure</th>
                        <th class="text-center" st-sort="share" style="width: 5%">&nbsp;&nbsp;Share</th>
												<th class="text-center" st-sort="pre_checkin" style="width: 5%">&nbsp;&nbsp;Pre</th>
                        <th class="text-center" st-sort="is_arrived" style="width: 5%">&nbsp;&nbsp;Arrived</th>
                        <th class="text-center" st-sort="dnd" style="width: 4%">&nbsp;&nbsp;DND</th>
                        <th class="text-center" st-sort="cos" style="width: 5%">&nbsp;&nbsp;COS</th>
                        <th class="text-center" st-sort="ml" style="width: 4%">&nbsp;&nbsp;Message</th>
                        <th class="text-center" st-sort="vip" style="width: 4%">&nbsp;&nbsp;VIP</th>
												<th class="text-center" st-sort="email" style="width: 4%">&nbsp;&nbsp;Email</th>
                        <th class="text-center" st-sort="mobile" style="width: 4%">&nbsp;&nbsp;Mobile</th>
                        <th class="text-center" st-sort="ack" style="width: 4%">&nbsp;&nbsp;SMS</th>
                        <th class="text-center" st-sort="checkout_flag" style="width: 5%">&nbsp;&nbsp;Status</th>
                        <th class="text-center" st-sort="checkout_flag" style="width: 6%">&nbsp;&nbsp;Action</th>
                    </tr>
				</thead>
                <tbody ng-hide="isLoading" style="{{box_height}}; display:block;">
                    <tr class="" ng-repeat="row in guestlist">

                        <td class="text-center" style="width: 5%">

                            <a>{{row.id}}</a>
                        </td>
                        <td class="text-center" style="width: 6%">{{row.building}}</td>
												<td class="text-center" style="width: 6%">{{row.room}}</td>
												<td style="width: 12%">{{row.guest_name}}
													<div ng-show="row.active_fac.length>0" class="pull-right">
				                    <span class="label m-l-sm bg-active-warning">Active</span>
														<i class="fa fa-chevron-right fa-xs btn rounded" ng-show="!open" ng-click="open=true" data-toggle="tooltip" title="Active Facilities" data-placement="bottom"></i>
														<i class="fa fa-chevron-left fa-xs btn rounded" ng-show="open" ng-click="open=false" data-toggle="tooltip" title="Active Facilities" data-placement="bottom" ></i>
														<span class="label m-l-sm bg-default" ng-show="open"
															ng-repeat="loc in row.active_fac | limitTo:11" >
															{{::loc.location}}
														</span>
													</div>
												</td>
                        <td class="text-center" style="width: 7%">{{row.guest_id}}</td>
                        <td class="text-center" style="width: 7%">{{row.arrival | mydate}}</td>
                        <td class="text-center" style="width: 7%">{{row.departure | mydate}}</td>
                        <td class="text-center" style="width: 5%">{{row.share == 1 ? 'Shared' : 'Single'}}</td>
                        <td class="text-center" style="width: 5%">{{row.pre_checkin == 1 ? 'Yes' : 'No'}}</td>
                        <td class="text-center" style="width: 5%">{{row.is_arrived == 1 ? 'Yes' : 'No'}}</td>
                        <td class="text-center" style="width: 4%">{{row.dnd == 1 ? 'Yes' : 'No'}}</td>
                        <td class="text-center" style="width: 5%">{{row.cos}}</td>
                        <td class="text-center" style="width: 4%">{{row.ml == 1 ? 'Yes' : 'No'}}</td>
                        <td class="text-center" style="width: 4%">{{row.vip_name}}</td>
                        <td class="text-center" style="width: 4%">{{row.email}}</td>
                        <td class="text-center" style="width: 4%">{{row.mobile}}</td>
                        <td class="text-center" style="width: 5%">
                          <div	style=" padding: 0px; ">
										        <span class="fa-stack text-danger" ng-if="row.ack==0" >
								            	<i class="fa fa-times fa-stack-1x" style="font-size:.7vw"> </i>
									        	</span>
									        	<span class="fa-stack text-success" ng-if="row.ack==2">
									        	  <i class="fa fa-check fa-stack-1x" style="margin-left:4px font-size:.7vw;"></i>
									        	  <i class="fa fa-check fa-inverse fa-stack-1x" style="margin-left:-3px; font-size:.7vw;"></i>
									        	  <i class="fa fa-check fa-stack-1x" style="margin-left:-4px; font-size:.7vw;"></i>
									        	</span>
                          </div>
                        </td>
                        <td class="text-center" style="width: 5%">{{row.checkout_flag}}</td>
                        <td class="text-center" style="width: 6%">
                          <span>

                            <button class="btn btn-icon btn-xs btn-primary" data-toggle="tooltip" title="View Detail" ng-click="viewDetail(row)" style="padding-bottom: 5px;">&nbsp;
                              <i class="fa fa-info text-sm" style="margin-right: 5px;"></i>&nbsp;
                            </button>
                            &nbsp; 
                            <button class="btn btn-icon btn-xs btn-danger" data-toggle="tooltip" title="View Log" ng-click="viewLogs(row)" style="padding-bottom: 5px">&nbsp;
                              <i class="fa fa-history text-sm" style="margin-right: 5px;"></i>&nbsp;
                            </button>
                            &nbsp;
                            <button class="btn btn-icon btn-info rounded"  data-toggle="tooltip" title="Facilities" ng-if="auth_svc.isValidModule('app.guestservice.facilities')" ng-click="addUtil(row)"><i class="fa fa-bath fa-fw"></i></button>


                            <!--<a href="url"><i class="fa fa-whatsapp" aria-hidden="true"></i></a>
                            <!--<button class="btn btn-info btn-xs btn-primary" ng-click="viewDetail(row)" style="padding-bottom: 5px">&nbsp;
                              <i class="fa fa-info text-sm" style="margin-right: 5px;"></i>&nbsp;
                            </button>-->

                          </span>
                        </td>
                    </tr>
                </tbody>
                <tbody ng-show="isLoading">
                    <tr>
                        <td colspan="18" class="text-center"><i class="fa fa-spin fa-refresh"></i></td>
                    </tr>
                </tbody>
                <tfoot ng-hide="isLoading">
                    <tr ng-show="paginationOptions.totalItems > paginationOptions.pageSize">
                        <td colspan="10" class="text-center">
                            <div st-pagination="" st-items-by-page="paginationOptions.pageSize" st-displayed-pages="7" class="no-margin"></div>
                        </td>
                    </tr>
                </tfoot>
            </table>
        </div>
        
        
        
        <!-- Mobile Briefing Room View -->
        <div class="wrapper bg-light lter b-b" ng-show="mobile_flag">
        	<div class="btn-group pull-right">
            <button type="button" class="btn btn-sm btn-bg btn-default" style="margin-left: 10px">
              {{paginationOptions.numberOfPages}}/{{paginationOptions.countOfPages}} - {{paginationOptions.totalItems}} Items
            </button>
            <button type="button" class="btn btn-sm btn-bg btn-default" ng-click="onPrevPage()" ng-disabled="paginationOptions.numberOfPages <= 1">
              <i class="fa fa-chevron-left"></i>
            </button>
            <button type="button" class="btn btn-sm btn-bg btn-default" ng-click="onNextPage()"
              ng-disabled="paginationOptions.numberOfPages >= paginationOptions.countOfPages">
              <i class="fa fa-chevron-right"></i>
            </button>
          </div>

          <div class="btn-toolbar" style="padding-left: 2px">
            <div class="row col-md-7" style="margin: auto"  ng-if="auth_svc.isValidModule('app.guestservice.facilities')">
	            <button class="btn btn-sm btn-icon bg-all pull-right" data-toggle="tooltip" title="Show All" data-placement="bottom" ng-click="onFilter(1)">
								<i class=""></i><label><b>ALL</b></label>
							</button>
							<button class="btn btn-sm btn-icon bg-wakeup-success pull-right" data-toggle="tooltip" title="Active Facilities" data-placement="bottom" ng-click="onFilter(3)">
								<!-- In-Progress -->
								<i class="fa fa-sign-out fa-fw"></i>
							</button>
						</div>                    
          </div>
        </div>
        
        <div class="bg-light lter multiDemo" style="width:100%; padding: 0px; margin: 0px"
            ng-style="{'height': tab_height, 'overflow-y': 'auto'}" ng-show="mobile_flag" ng-init="onFilter(1)">
	          <ul id="list_ticket" class="list-group list-group-lg no-radius table-striped m-b-none m-t-n-xxs" >
              <li ng-repeat="row in guestlist" 
								class="list-group-item clearfix b-l-5x"
                ng-class="{'selected': row.active}"
                style="padding-bottom: 0px">                    
                <div class="clear text-sm"  style="padding: 0px">                   
                  <div class="clear">                 
                    <label class="font-bold pull-left">                                
                      <i class="fa fa-hotel text-info"></i>&nbsp;{{row.room}}
                    </label>
                    <div ng-show="row.active_fac.length>0">
	                    <span class="label m-l-sm bg-active-warning">Active</span>
											<i class="fa fa-chevron-right fa-xs btn rounded" ng-show="!open" ng-click="open=true" data-toggle="tooltip" title="Active Facilities" data-placement="bottom"></i>
											<i class="fa fa-chevron-left fa-xs btn rounded" ng-show="open" ng-click="open=false" data-toggle="tooltip" title="Active Facilities" data-placement="bottom" ></i>
											<span class="label m-l-sm bg-default" ng-show="open"
												ng-repeat="loc in row.active_fac | limitTo:11" >
												{{::loc.location}}
											</span>
										</div>
                  </div>
                  <div class="text-ellipsis text-sm clear" style=" width: 100%; margin: 0px">                             
                    <label>&nbsp;<i class="fa fa-user text-primary"></i>
                    	&nbsp;{{row.guest_name}}&nbsp;| <i class="fa fa-clock">Occupancy:</i>&nbsp;{{row.share == 1 ? 'Shared' : 'Single'}}
                    </label>
					<div class="pull-right" style="margin-right: 6px; margin-top: -1px">
                          <span>
                            <button class="btn btn-info btn-xs btn-primary" ng-click="viewDetail(row)" style="padding-bottom: 5px">&nbsp;
                              <i class="fa fa-info text-sm" style="margin-right: 5px;"></i>&nbsp;
                            </button>
                          </span>
                      </div>
                    <div class="pull-right" style="margin-right: 6px; margin-top: -1px">
	                    <button class="btn btn-sm btn-icon btn-info rounded"  data-toggle="tooltip" title="Facilities" ng-click="addUtil(row)" ng-if="auth_svc.isValidModule('app.guestservice.facilities')"><i class="fa fa-bath fa-fw"></i></button>
                    </div>
                  </div>
                  <div class="text-ellipsis text-sm" style="width: 100%; margin-top: 0px">
                    <label>
                      <a style="color:#5499C7;"  popover-trigger="mouseenter"
                        popover-placement="right" popover-title="{{row.status_text}}">Arrival:{{row.arrival | mydate}}&nbsp;&nbsp;|Departure:{{row.departure | mydate}}</a>
                    </label>
                  </div>
                </div>
              </li>
            </ul>
        </div>
		<!-- Mobile Briefing Room View -->
	
</div>
