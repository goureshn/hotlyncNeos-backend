<div class="hbox" ng-controller="GuestFacilityController">
    <style>
        .tab-container .tab-content {
            padding: 0px;
        }

        .nopadding {
            padding: 0 !important;
            margin: 0 !important;
        }

        .splitdiv {
            border-right: 1px solid #d7d6d4;
            border-bottom: 1px solid #d7d6d4;
        }

        .popover-container .popover-content {
            padding-left: 6px;
            padding-right: 6px;

        }

        .popover-container .popover {
            max-width: 650px;
        }


        .pink{
            background-color: rgb(250, 131, 33);
        }

        .popover-title {
            font-weight: bold;
        }

        table thead tr{
            height: 50px;
        }

        .ticket-table tbody tr {
            height: 65px;
        }

        table tbody tr td {
            padding-left: 5px !important;
            padding-right: 5px !important;
        }

        .select2 > .select2-choice.ui-select-match {
            /* Because of the inclusion of Bootstrap */
            height: 29px;
        }

    </style>

    <script type="text/ng-template" id="Comments.html">
        <div class="text-ellipsis text-sm clear font-bold small" style="white-space: normal;" >
            {{row.remark}}
        </div>
    </script>

    <script type="text/ng-template" id="filter_template.html">
        <div style="width: 400px">
            <form class="form-horizontal form-validation" ng-submit="createFacility()">
                <div class="form-group">
                   <!-- Guest Type Filter -->
                   <div class="col-sm-12">
                    <label class="control-label text-xs text-muted">Guest Type : </label>
                    <div class="scrollable-dropdown-menu">
                        <ui-select ng-model="guest_type_selected" theme="select2" style="min-width: 100%;" title="Choose Guest Type"
                            on-select="onSelectGuestType($item, $model)"
                            >
                            <ui-select-match placeholder="Guest Type">{{$select.selected}}</ui-select-match>
                            <ui-select-choices repeat="row in guest_types">
                                <div ng-bind-html="row | highlight: $select.search"></div>
                            </ui-select-choices>
                        </ui-select>
                    </div>
                    </div>


                    <!-- Location Filter -->
                    <div class="col-sm-12">
                        <label class="control-label text-xs text-muted">Room : </label>
                        <div class="scrollable-dropdown-menu">
                            <tags-input ng-model="filter.room_tags" display-property="room" key-property="id"
                                style="margin-top: -5px"
                                placeholder="Add Room"
                                on-tag-added="pageChanged()" on-tag-removed="pageChanged()"
                                replace-spaces-with-dashes="false"  >
                                <auto-complete source="roomTagFilter($query)"
                                                min-length="0"
                                                load-on-focus="true"
                                                load-on-empty="true"
                                                debounce-delay="0"
                                                max-results="10"
                                                >
                                </auto-complete>
                            </tags-input>
                        </div>
                    </div>

                  

                   
                </div>
            </form>
        </div>
    </script>

    <div>
        <div class="hbox">
            <div class="col b-r" style="width:80vw;">
                <div class="wrapper bg-light lter b-b">
                    <div class="btn-group pull-right">
                        <button type="button" class="btn btn-sm btn-bg btn-default">
                            {{paginationOptions.numberOfPages}}/{{paginationOptions.countOfPages}} - {{paginationOptions.totalItems}} Items
                        </button>
                        <button type="button" class="btn btn-sm btn-bg btn-default" ng-click="onPrevPage()" ng-disabled="paginationOptions.numberOfPages <= 1">
                            <i class="fa fa-chevron-left"></i>
                        </button>

                        <button type="button" class="btn btn-sm btn-bg btn-default" ng-click="onNextPage()" ng-disabled="paginationOptions.numberOfPages >= paginationOptions.countOfPages">
                            <i class="fa fa-chevron-right"></i>
                        </button>
                    </div>

                    <div class="btn-toolbar" style="padding-left: 2px">
                        <div class="btn-group">
                            <h3 class="m-n font-thin" style="color: #5fbae8;">Guest Facility&nbsp;&nbsp;</h3>
                        </div>
                        <div class="btn-group popover-container">
                            <button id="dateranger" class="btn btn-sm btn-icon btn-default" data-toggle="tooltip" data-placement="bottom"
                                    title="Date" ui-jq="daterangepicker" ui-options="dateRangeOption">
                                <i class="glyphicon glyphicon-calendar"></i>
                            </button>
                            <button class="btn btn-sm btn-icon btn-default" data-toggle="tooltip" title="Refresh"
                                    data-placement="bottom" ng-click="refreshTickets()">
                                <i class="fa fa-refresh"></i>
                            </button>
                            <button class="btn btn-sm btn-bg btn-default" data-toggle="tooltip" data-placement="bottom" title="View Mode" ng-click="listmode=!listmode">
                                <i ng-if="listmode" class="fa fa-list"></i><i ng-if="!listmode" class="icon-grid"></i>
                            </button>

                            <button class="btn btn-sm btn-icon btn-default" data-toggle="tooltip" title="Filter" data-placement="bottom"
                                uib-popover-template="'filter_template.html'" popover-trigger="outsideClick" popover-placement="bottom-left">
                                <i class="fa fa-filter" ng-style="{'color': filter_apply ? '#23b7e5' : '#58666e'}"></i>
                            </button>
                        </div>

                        <div class="input-group col-md-2 pull-left">
                            <input type="text" ng-model="searchtext" ng-keyup="pageChanged()" class="form-control input-sm bg-light no-border rounded padder"
                                   placeholder="Search">
                            <span class="input-group-btn">
                                <button type="submit" class="btn btn-sm bg-light rounded">
                                    <i class="fa fa-search"></i>
                                </button>
                            </span>
                        </div>
                        <div class="col-sm-2">
                            <button type="button" class="btn btn-sm btn-bg btn-default" ng-click="onExportExcel()">
                                <i class="fa fa-file-excel-o"></i>&nbsp;Export Excel
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="wrapper" style="text-align: right;">
                <button type="button" class="btn btn-sm btn-bg btn-default" ng-click="Close()" ng-show="detailview">
                    <i class="fa fa-window-close" aria-hidden="true"></i>&nbsp;Close
                </button>
                <button type="button" class="btn btn-sm btn-bg btn-default" ng-click="onCreate()">
                    <i class="fa fa-plus-circle"></i>&nbsp;New
                </button>
            </div>
        </div>

        <div>

            <!-- list -->
            <div class="bg-light lter" style="width:100%">
                <ul id="list_ticket" class="list-group list-group-lg no-radius table-striped m-b-none m-t-n-xxs" ng-style="{'height': ticketlist_height}"  ng-if="listmode">
                    <li ng-repeat="row in ticketlist" class="list-group-item  clearfix b-l-5x ">
                        <div class="clear" >
                            <div>
                                <a class="text-sm">
                                    <i class="fa fa-ticket"></i>&nbsp;{{getTicketNumber(row)}}&nbsp;-&nbsp;
                                    <i class="glyphicon glyphicon-home" ></i>&nbsp;{{::row.guest_type}}&nbsp;&nbsp;
                                    <i class="icon-user"></i>&nbsp;{{row.guest_name}}&nbsp;&nbsp;
                                    <i class="fa fa-id-badge"></i>&nbsp;{{row.vip}}&nbsp;&nbsp;
                                    <i class="fa fa-users"></i>&nbsp;{{row.adult}}&nbsp;&nbsp;
                                    <i class="fa fa-child"></i>&nbsp;{{row.child}}&nbsp;&nbsp;
                                </a>
                            </div>
                            <span class="label bg-light m-l-sm " >Stay - {{::row.stay}}</span>
                            <span class="label bg-light m-l-sm ">Breakfast Included: {{row.bmeal}}</span>

                        </div>
                    </li>
                </ul>
            </div>

            <!-- / list -->
            <!-- Grid Table -->

            <div class="portlet" ng-if="!listmode" ng-style="{'height': ticketlist_height, 'overflow-y': 'auto'}">
                <div class="portlet-body">
                    <div class="table table-responsive">
                        <table  st-table="ticketlist" style="table-layout: fixed" st-pipe="pageChanged" class="table ticket ticket-table table-striped b-t b-light">
                            <thead class="tblhead-sm" style="font-size: .8vw">
                            <tr class="text-center">
                                <th class="text-center" st-sort="id" st-sort-default="reverse" style="width:7%"><b>&nbsp;&nbsp;ID</b></th>
                                <th class="text-center" st-sort="created_at" style="width:40px"><b>Date & Time</b></th>
                                <th class="text-center" st-sort="guest_type" style="width:13%"><b>Guest Type</b></th>
                                
                                <th class="text-center"  style="width:13%"><b>Main Guest Name</b></th>
                                <th class="text-center" st-sort="vip" style="width:5%"><b>Room</b></th>
                                <th class="text-center" st-sort="vip" style="width:5%"><b>VIP</b></th>
                                <th class="text-center" style="width:50px"><b>Stay</b></th>
                                <!--
                                <th class="text-center" style="width:10%"><b>Email</b></th>
                                <th class="text-center" style="width:9%"><b>Mobile</b></th>
                                -->
                                <th class="text-center" st-sort="adult" style="width:9%"><b>Adult</b></th>
                                <th class="text-center" st-sort="child" style="width:6%"><b>Kids</b></th>
                                <th class="text-center" st-sort="bmeal" style="width:6%"><b>BMeal</b></th>
                                <th class="text-center" st-sort="table_no" style="width:6%"><b>Table No</b></th>
                                <th class="text-center" style="width:5%"><b>Remarks</b></th>
                                <th class="text-center" style="width:7%"><b>Exit</b></th>
                                <th class="text-center" st-sort="exit_time" style="width:40px"><b>Exit Time</b></th>
                               
                            </tr>
                            </thead>

                            <tbody >
                                <tr class="highlight2 no-radius m-b-none m-t-n-xxs" ng-repeat="row in ticketlist" >
                                    <td class="highlight" style="white-space: nowrap; border-left: 8px solid {{::row.ticket_type_color}};margin-top: 4px ;margin-bottom: 6px;text-align:center;">
                                        <div class="text-sm" title="{{getTicketNumber(row)}}" style="display:inline-block; width:100%; max-width:100%; overflow: hidden; text-overflow:ellipsis;">
                                            <a>{{getTicketNumber(row)}}</a>
                                        </div>
                                    </td>
                                    <td class="highlight" style="white-space: nowrap; text-align:center">
                                        <div class="text-sm" title="{{::row.created_at | mydatetime}}" style="display:inline-block; width:100%; max-width:100%; overflow: hidden; text-overflow:ellipsis;">
                                            <a>
                                                {{::row.created_at | mydatetime}}
                                                
                                            </a>
                                        </div>
                                    </td>
                                    <td class="highlight" style="white-space: nowrap;text-align:center;">
                                        <div title="{{::row.guest_type}}" class="text-sm" style="display:inline-block; width:100%; max-width:100%; overflow: hidden; text-overflow:ellipsis;">
                                            <a> {{::row.guest_type}}</a>
                                        </div>
                                    </td>
                                   
                                    <td class="highlight" style="white-space: nowrap;text-align:center;">
                                        <div class="text-sm" title="{{::row.guest_name}}" style="display:inline-block; width:100%; max-width:100%; overflow: hidden; text-overflow:ellipsis;">
                                            <a>&nbsp;{{::row.guest_name}}</a>
                                        </div>
                                    </td>
                                    <td class="highlight"  style="white-space: nowrap;text-align:center;">
                                        <div class="text-sm" title="{{::row.room}}" style="display:inline-block; width:100%; max-width:100%; overflow: hidden; text-overflow:ellipsis;">
                                            <a> {{::row.room}}</a>
                                        </div>
                                    </td>
                                    <td class="highlight"  style="white-space: nowrap;text-align:center;">
                                        <div class="text-sm" title="{{::row.vip}}" style="display:inline-block; width:100%; max-width:100%; overflow: hidden; text-overflow:ellipsis;">
                                            <a> {{::row.vip}}</a>
                                        </div>
                                    </td>
                                 
                                    <td class="highlight" style="white-space: nowrap; text-align:center">
                                        <div class="text-sm" title="{{row.stay}}" style="display:inline-block; width:100%; max-width:100%; overflow: hidden; text-overflow:ellipsis;">
                                           <a> {{::row.stay}}</a> 
                                       
                                        </div>
                                    </td>
                                    <!--
                                    <td class="highlight" style="white-space: nowrap; text-align:center">
                                        <div class="text-sm" title="{{row.email}}" style="display:inline-block; width:100%; max-width:100%; overflow: hidden; text-overflow:ellipsis;">
                                           <a> {{::row.email}}</a> 
                                       
                                        </div>
                                    </td>
                                    <td class="highlight" style="white-space: nowrap; text-align:center">
                                        <div class="text-sm" title="{{row.mobile}}" style="display:inline-block; width:100%; max-width:100%; overflow: hidden; text-overflow:ellipsis;">
                                           <a> {{::row.mobile}}</a> 
                                       
                                        </div>
                                    </td>
                                    -->
                                    <td class="highlight" style="white-space: nowrap;text-align:center;">
                                        <div class="text-sm" title="{{::row.adult}}" style="display:inline-block; width:100%; max-width:100%; overflow: hidden; text-overflow:ellipsis;">
                                            <a> &nbsp;{{::row.adult}}</a>
                                        </div>
                                    </td>
                                    <td class="highlight" style="white-space: nowrap;text-align:center;">
                                        <div class="text-sm" title="{{::row.child}}" style="display:inline-block; width:100%; max-width:100%; overflow: hidden; text-overflow:ellipsis;">
                                            <a> &nbsp;{{::row.child}}</a>
                                        </div>
                                    </td>
                                    <td class="highlight"  style="white-space: nowrap;text-align:center;">
                                        <div class="text-sm" title="{{::row.bmeal}}" style="display:inline-block; width:100%; max-width:100%; overflow: hidden; text-overflow:ellipsis;">
                                            <a> {{::row.bmeal}}</a>
                                        </div>

                                    </td>
                                    <td class="highlight"  style="white-space: nowrap;text-align:center;">
                                        <div class="font-bold text-sm" title="{{::row.table_no}}" style="display:inline-block;width:100%; max-width:100%; overflow: hidden;text-overflow:ellipsis;">
                                        <a> {{::row.table_no}}</a>
                                        </div>
                                    </td>
                                    <td class="highlight"  style="white-space: nowrap;text-align:center;">
                                        <span type="text"
                                                uib-popover-template="'Comments.html'" popover-trigger="mouseenter" popover-title="Remarks"
                                                popover-placement="bottom">
                                                <i ng-show="row.remark != ''" class="fa fa-comment" style="font-size: 12px; color: #1565C0;"></i>
                                        </span>
                                    </td>

                                    <td class="highlight"  style="white-space: nowrap;text-align:center;">
                             
                                        <a ng-show = "row.exit_flag == 0" class="btn default btn-xs red" ng-click="exit(row)">
                                            <i class="fa fa-sign-out"></i></a>
                                        <a ng-show="row.exit_flag == '1'" class="btn default btn-xs orange" >Exited
                                                </a> 
                                    </td>
                                    <td class="highlight" style="white-space: nowrap; text-align:center">
                                        <div class="text-sm" title="{{::row.exit_time | mydatetime}}" style="display:inline-block; width:100%; max-width:100%; overflow: hidden; text-overflow:ellipsis;">
                                            <a>
                                                {{::row.exit_time | mydatetime}}
                                                
                                            </a>
                                        </div>
                                    </td>
                                   
                                </tr>
                            </tbody>
                            <tbody ng-show="isLoading">
                                <tr>
                                    <td colspan="10" class="text-center"><i class="fa fa-spin fa-refresh"></i></td>
                                </tr>
                            </tbody>
                            <tfoot ng-hide="isLoading" ng-if="0">
                                <tr ng-show="paginationOptions.totalItems > paginationOptions.pageSize">
                                    <td colspan="10" class="text-center">
                                        <div st-pagination="" st-items-by-page="paginationOptions.pageSize" st-displayed-pages="7" class="no-margin"></div>
                                    </td>
                                </tr>
                            </tfoot>

                        </table>
                    </div>
                </div>
            </div>


        </div>


    </div>
</div>
