<style>
    .total_count {
        background-color: #2c3e50;
        margin-bottom: 0px;
        border-radius: 6px;
    }

    .create_menu a {
        height: 0px;
        margin-top: -2px;
    }


     nav {
         position: relative;
         z-index: 1;
         white-space: nowrap;
         font-size: 12px;;
     }

    nav a {
        position: relative;
        display: inline-block;
        padding: 1.5em 1.5em 1em;
        text-decoration: none;
        margin: 0 -5px;
        color: #fff;
    }

    nav a:hover {
        color: #ef6905;
    }

    nav a::before,
    main {
        border-top: .12em solid #aaa;
    }

    nav a::before {
        content: ''; /* To generate the box */
        position: absolute;
        top: 0; right: 0; bottom: .5em; left: 0;
        z-index: -1;
        margin-bottom: 1px;
        border-bottom: none;
        border-radius: 10px 10px 0 0;
        background: #2e3344;
        box-shadow: 0 2px hsla(0,0%,100%,.5) inset;
        transform: perspective(5px) rotateX(2deg);
        transform-origin: bottom;
    }

    nav.left a {
        padding: 1.5em 2em 1em 1em;
    }

    nav.left a::before {
        transform-origin: bottom left;
    }

    nav.right a {
        padding: 1.5em 1em 1em 2em;
    }

    nav.right a::before {
        transform-origin: bottom right;
    }

    nav a.selected {
        z-index: 2;
    }

    nav a.selected::before {
        margin-bottom: 1px;
        border-top-width: 1px;
    }

    nav a.selected::before
    {
        background: #0e08b6;
    }

    main {
        display: block;
        margin-bottom: 1px;
        margin: -8px 0px 20px -29px;
        /*border-radius: 3px;*/
        background:#fff;
    }
    .nav-tabs {
        border-bottom: 0px;
    }

    .popover-container .popover-content {
        padding-left: 6px;
        padding-right: 6px;        
    }

    .popover-container .popover {
        max-width: 650px;
    }
</style>

<div  ng-controller="AlarmLogController" >

    <script type="text/ng-template" id="staff-template">
        <div class="autocomplete-template">
            <div class="right-panel">
                <span ng-bind-html="$highlight($getDisplayText())"></span><br>
                <span style="font-size: 10px">{{data.job_role_name}} </span>
            </div>
        </div>
    </script>

    <script type="text/ng-template" id="location-template">
        <div class="autocomplete-template">
            <div class="right-panel">
                <span ng-bind-html="$highlight($getDisplayText())"></span><br>
                <span style="font-size: 10px">{{data.type}} </span>
            </div>
        </div>
    </script>

    <script type="text/ng-template" id="filter_template.html">        
        <div style="width: 400px">
            <form class="form-horizontal form-validation">        
                <div class="form-group">
                    <!-- Alarm Name Filter -->        
                    <div class="col-sm-12">
                        <label class="control-label text-xs text-muted">Alarm Name : </label>
                        <div class="scrollable-dropdown-menu">
                            <tags-input ng-model="filter.alarm_name_tags" display-property="name" key-property="id"
                                style="margin-top: -5px"
                                placeholder="Add Alarm Name"
                                on-tag-added="getDataList()" on-tag-removed="getDataList()"
                                replace-spaces-with-dashes="false"  >
                                <auto-complete source="alarmNameTagFilter($query)"
                                                min-length="0"
                                                load-on-focus="true"
                                                load-on-empty="true"
                                                debounce-delay="0"
                                                max-results="10"
                                                template="location-template"
                                                >
                                </auto-complete>
                            </tags-input>
                        </div>
                    </div>
                    <!-- Created By Filter -->
                    <div class="col-sm-12">
                        <label class="control-label text-xs text-muted">Created By : </label>
                        <div class="scrollable-dropdown-menu">
                            <tags-input ng-model="filter.staff_tags" display-property="wholename" key-property="id"
                                    style="margin-top: -5px"
                                    placeholder="Created By"
                                    on-tag-added="getDataList()" on-tag-removed="getDataList()"
                                    replace-spaces-with-dashes="false"  >
                                    <auto-complete source="staffTagFilter($query)"
                                                    min-length="0"
                                                    load-on-focus="true"
                                                    load-on-empty="true"
                                                    debounce-delay="0"
                                                    max-results="10"
                                                    template="staff-template">
                                    </auto-complete>
                            </tags-input>
                        </div>
                    </div>           

                    <!-- Status Filter -->        
                    <div class="col-sm-12">
                        <label class="control-label text-xs text-muted">Status : </label>
                        <div class="scrollable-dropdown-menu">
                            <select class="form-control input-sm" ng-model="filter.status_name" ng-change="getDataList()"
								ng-options="value for value in status_list">		
							</select>				
                        </div>
                    </div>             


                    
                </div>
            </form>       
        </div>    
    </script>

    <div class="hbox" style="overflow-y: auto;background-color: #ffffff;" >
        <div class="row">
            <div class="col-sm-12">
                <div class="b-r">
                    <!-- header -->
                    <div class="wrapper bg-light lter b-b" style="margin: -3px">
                        <div class="btn-group pull-right">
                            <button type="button" class="btn btn-sm btn-bg btn-default">
                                {{paginationOptions.numberOfPages}}/{{paginationOptions.countOfPages}} - {{paginationOptions.totalItems}} Items
                            </button>
                            <button type="button" class="btn btn-sm btn-bg btn-default" ng-click="onPrevPage()" ng-disabled="paginationOptions.numberOfPages <= 1">
                                <i class="fa fa-chevron-left"></i>
                            </button>
                            <button type="button" class="btn btn-sm btn-bg btn-default" ng-click="onNextPage()"
                                    ng-disabled="paginationOptions.numberOfPages >= paginationOptions.countOfPages">
                                <i class="fa fa-chevron-right"></i>
                            </button>
                        </div>
                        <div class="btn-toolbar" style="padding-left: 11px">
                            <div class="btn-group" style="margin-top: 2px;">
                                <h1 class="m-n font-thin h5 text-black" style="color:#337ab7">
                                    <label style="font-size: 1.3vw; margin-bottom: 0px">
                                        <!--<i class="fa fa-bell"></i>
                                        Active Alarm-->
                                    </label>
                                </h1>
                            </div>
                            <div class="btn-group popover-container">
                                <button id="dateranger_" class="btn btn-sm btn-icon btn-default" data-toggle="tooltip" title="Filter" data-placement="bottom" ui-jq="daterangepicker" ui-options="dateRangeOption"	 data-title="Refresh" ng-click="onClickDateFilter()">
                                    <i class="fa fa-calendar"></i>
                                </button>
                                <button class="btn btn-sm btn-icon btn-default" data-toggle="tooltip" title="Filter" data-placement="bottom" 
                                    uib-popover-template="'filter_template.html'" popover-placement="bottom-left">
                                    <i class="fa fa-filter" ng-style="{'color': filter_apply ? '#23b7e5' : '#58666e'}"></i>
                                </button>
                            </div>
                            
                            <div class="input-group col-md-3 pull-left" style="padding-left: 10px">
                                <input type="text" ng-model="searchtext" ng-keyup="onSearch()" class="form-control input-sm bg-light no-border rounded padder" placeholder="store name/title">
                                <span class="input-group-btn">
                                    <button type="submit"   class="btn btn-sm bg-light rounded"><i class="fa fa-search"></i></button>
                                </span>
                            </div>
                            <div class="col-sm-2">
                                <button type="button" class="btn btn-sm btn-bg btn-default" ng-click="onShowReportDialog()">
                                    <i class="fa fa-bar-chart"></i>&nbsp;Export Report
                                </button>                               
                            </div>
                            
                        </div>
                    </div>
                    <!-- / header -->
                    <!-- Grid Table -->
                    <div class="portlet" style="width: 100%">
                        <div class="portlet-body" style="overflow-y: auto">
                            <div class="table table-responsive" style="{{tab_full_height}}">
                                <table  st-table="datalist"  st-pipe="getDataList" class="table ticket table-striped b-t b-light">
                                    <thead class="tblhead-sm" style="font-size: .8vw; height: 30px">
                                    <tr>
                                        <th class="text-center" style="white-space: nowrap">
                                            <b>&nbsp;Alarm</b>
                                        </th>
                                        <th class="text-center" style="white-space: nowrap">
                                            <b>&nbsp;Type</b>
                                        </th>
                                        <th class="text-center" style="white-space: nowrap">
                                            <b>&nbsp;Created By</b>
                                        </th>
                                        <th class="text-center" style="white-space: nowrap">
                                            <b>&nbsp;Message</b>
                                        </th> 
                                        <th class="text-center" style="white-space: nowrap">
                                            <b>&nbsp;Comment</b>
                                        </th>                                                        
                                        <th class="text-center"><b>Location</b></th>
                                        <th class="text-center"><b>Created On</b></th>
                                        <th class="text-center"><b>Ack Count</b></th>
                                        <th class="text-center" style="white-space: nowrap">
                                            <b>&nbsp;Cleared By</b>
                                        </th>
                                        <th class="text-center"><b>Cleared On</b></th>
                                        <th class="text-center" ><b>Status</b></th>
                                    </tr>
                                    </thead>
                                    <tbody ng-hide="isLoading" style="font-size: .8vw">
                                    <tr class="text-center" ng-repeat="row in datalist " ng-click="onShowUsers(row)" style="cursor:pointer;">
                                        <td>{{row.alarm_name}}</td>
                                        <td>
                                            <label ng-if="row.kind=='0'">Notification</label>
                                            <label ng-if="row.kind=='1'">Escalation</label>
                                        </td>
                                        <td>{{row.sender_user_name}}</td>
                                        <td  class="text-left">{{row.updated_description}}</td>
                                        <td  class="text-left">{{row.message}}</td>
                                        <td  class="text-left">{{row.location}}</td>
                                        <td>{{row.created_at | mydatetime}}</td>
                                        <td>{{row.ack_count}}/{{row.notify_count}}</td>
                                        <td>{{row.clear_user_name}}</td>
                                        <td>{{row.clear_at | mydatetime}}</td>
                                        <td>
                                            <a class="btn default btn-xs green" style="margin-right:10px;width:50px;" ng-if="row.status == 1 || row.status == 2" >
                                                 {{showPermission(row.status)}} 
                                            </a>
                                            <a class="btn default btn-xs red" style="margin-right:10px;width:50px;" ng-if="row.status == 3" >
                                                 {{showPermission(row.status)}} 
                                            </a>
                                            <a ng-if="row.status == 3"  class="btn default btn-xs red" ng-click="exportPDF(row)">
                                                <i class="fa fa-file-pdf-o"></i>
                                            </a>   
                                        </td>                                        
                                    </tr>
                                    </tbody>
                                    <tbody ng-show="isLoading">
                                    <tr>
                                        <td colspan="7" class="text-center"><i class="fa fa-spin fa-refresh"></i></td>
                                    </tr>
                                    </tbody>
                                    <tfoot ng-hide="true">
                                    <tr ng-show="paginationOptions.totalItems > paginationOptions.pageSize">
                                        <td colspan="7" class="text-center">
                                            <div st-pagination="" st-items-by-page="paginationOptions.pageSize" st-displayed-pages="7" class="no-margin"></div>
                                        </td>
                                    </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>    
            <!--// right side-->
            <!--
            <div class="col-sm-4" style="padding-left:0px;margin-top:5px;">                    
                <div ng-include="'tpl/alarm/logs_user.html'">
                </div>                        
            </div>
            -->    
            <!--//end right side-->
        </div>
    </div>
</div>
