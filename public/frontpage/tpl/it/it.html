<div class="hbox" ng-controller="MyIssueController" style="height:100%;" ng-init="asideFolded = false">
    

<style>
    .tab-container .tab-content {
        padding: 0px;
    }

    .nopadding {
        padding: 0 !important;
        margin: 0 !important;
    }

    .splitdiv {
        border-right: 1px solid #d7d6d4;
        border-bottom: 1px solid #d7d6d4;
    }

    .popover-container .popover-content {
        padding-left: 6px;
        padding-right: 6px;
       
    }

    .popover-container .popover {
        max-width: 650px;
    }

    .popover-title {
        font-weight: bold;
    }

</style>

<script type="text/ng-template" id="filter_template.html">        
    <div style="width: 250px">
        <form class="form-horizontal form-validation" ng-submit="createIssue()">        
            <div class="form-group">

                 <!-- Building Filter -->        
                 <div class="col-sm-12">
                        <label class="control-label text-xs text-muted">Building : </label>
                        <div class="scrollable-dropdown-menu">
                            <tags-input ng-model="filter.building_tags" display-property="name" key-property="id"
                                style="margin-top: -5px"
                                placeholder="Add Building"
                                on-tag-added="pageChanged()" on-tag-removed="pageChanged()"
                                replace-spaces-with-dashes="false"  >
                                <auto-complete source="buildingTagFilter($query)"
                                                min-length="0"
                                                load-on-focus="true"
                                                load-on-empty="true"
                                                debounce-delay="0"
                                                max-results="10"                                                
                                                >
                                </auto-complete>
                            </tags-input>
                        </div>
                    </div>  

                <!-- Department Filter -->
                <div class="col-sm-12">
                    <label class="control-label text-xs text-muted">Department : </label>
                    <div class="scrollable-dropdown-menu">
                        <tags-input ng-model="filter.dept_tags" display-property="department" key-property="id"
                                style="margin-top: -5px"
                                placeholder="Add Department"
                                on-tag-added="pageChanged()" on-tag-removed="pageChanged()"
                                replace-spaces-with-dashes="false"  >
                                <auto-complete source="deptTagFilter($query)"
                                                min-length="0"
                                                load-on-focus="true"
                                                load-on-empty="true"
                                                debounce-delay="0"
                                                max-results="10"
                                                >
                                </auto-complete>
                        </tags-input>
                    </div>
                </div>    
                
                  <!-- Status Filter -->        
                  <div class="col-sm-12">
                        <label class="control-label text-xs text-muted">Status : </label>
                        <div class="scrollable-dropdown-menu">
                            <tags-input ng-model="filter.status_tags" display-property="status" key-property="id"
                                style="margin-top: -5px"
                                placeholder="Add Status"
                                on-tag-added="pageChanged()" on-tag-removed="pageChanged()"
                                replace-spaces-with-dashes="false"  >
                                <auto-complete source="statusTagFilter($query)"
                                                min-length="0"
                                                load-on-focus="true"
                                                load-on-empty="true"
                                                debounce-delay="0"
                                                max-results="10"                                                
                                                >
                                </auto-complete>
                            </tags-input>
                        </div>
                    </div>  

                <!-- Type Filter -->        
                <div class="col-sm-12">
                    <label class="control-label text-xs text-muted">Type : </label>
                    <div class="scrollable-dropdown-menu">
                      <!--  <select class="form-control input-sm" ng-model="filter.type" ng-change="pageChanged()"
                            ng-options="value for value in type_list">		
                        </select>	
                    -->
                        <tags-input ng-model="filter.type_tags" display-property="type" key-property="id"
                        style="margin-top: -5px"
                        placeholder="Add Type"
                        on-tag-added="pageChanged()" on-tag-removed="pageChanged()"
                        replace-spaces-with-dashes="false"  >
                        <auto-complete source="typeTagFilter($query)"
                                        min-length="0"
                                        load-on-focus="true"
                                        load-on-empty="true"
                                        debounce-delay="0"
                                        max-results="10"
                                        >
                        </auto-complete>
                    </tags-input>
                    </div>
                </div>             

                <!-- Category Filter -->
                <div class="col-sm-12">
                    <label class="control-label text-xs text-muted">Category : </label>
                    <div class="scrollable-dropdown-menu">
                        <tags-input ng-model="filter.category_tags" display-property="category" key-property="id"
                            style="margin-top: -5px"
                            placeholder="Add Category"
                            on-tag-added="pageChanged()" on-tag-removed="pageChanged()"
                            replace-spaces-with-dashes="false"  >
                            <auto-complete source="categoryTagFilter($query)"
                                            min-length="0"
                                            load-on-focus="true"
                                            load-on-empty="true"
                                            debounce-delay="0"
                                            max-results="10"
                                            >
                            </auto-complete>
                        </tags-input>
                    </div>
                </div>         

                <!-- Sub Category Filter -->        
                <div class="col-sm-12">
                    <label class="control-label text-xs text-muted">Sub Category : </label>
                    <div class="scrollable-dropdown-menu">
                        <tags-input ng-model="filter.subcategory_tags" display-property="sub_cat" key-property="id"
                            style="margin-top: -5px"
                            placeholder="Add Sub Category"
                            on-tag-added="pageChanged()" on-tag-removed="pageChanged()"
                            replace-spaces-with-dashes="false"  >
                            <auto-complete source="subcatTagFilter($query)"
                                            min-length="0"
                                            load-on-focus="true"
                                            load-on-empty="true"
                                            debounce-delay="0"
                                            max-results="10"
                                            >
                            </auto-complete>
                        </tags-input>
                    </div>
                </div>

                <!-- User Filter -->        
                <div class="col-sm-12">
                    <label class="control-label text-xs text-muted">User : </label>
                    <div class="scrollable-dropdown-menu">
                        <tags-input ng-model="filter.user_tags" display-property="wholename" key-property="id"
                            style="margin-top: -5px"
                            placeholder="Add User"
                            on-tag-added="pageChanged()" on-tag-removed="pageChanged()"
                            replace-spaces-with-dashes="false"  >
                            <auto-complete source="userTagFilter($query)"
                                            min-length="0"
                                            load-on-focus="true"
                                            load-on-empty="true"
                                            debounce-delay="0"
                                            max-results="10"                                                
                                            >
                            </auto-complete>
                        </tags-input>
                    </div>
                </div>  
                
               
            </div>
        </form>       
    </div>    
</script>

    <div class="col" style="height:100%;" >
        <div class="wrapper b-b bg" ng-hide="true">
            <a href="" ng-click="asideFolded = !asideFolded">
                <i class="fa fa-fw {{asideFolded ? 'fa-dedent' : 'fa-indent'}}" style=""></i>
            </a>
        </div>
        <div>
            <div class="hbox" style="height:100%;">
                <div class="col b-r" style="width:40vw;">
                    <!--<script type="text/ng-template" id="cancelReasonModal.html">-->
                        <!--<div ng-include="'tpl/guestservice/modal/cancel_reason.html'"></div>-->
                    <!--</script>-->
                    <!-- header -->
                    <div class="wrapper bg-light lter b-b">
                        <div class="btn-group pull-right">
                            <button type="button" class="btn btn-sm btn-bg btn-default">
                                {{paginationOptions.numberOfPages}}/{{paginationOptions.countOfPages}} - {{paginationOptions.totalItems}} Items
                            </button>
                            <button type="button" class="btn btn-sm btn-bg btn-default" ng-click="onPrevPage()" ng-disabled="paginationOptions.numberOfPages <= 1">
                                <i class="fa fa-chevron-left"></i>
                            </button>
                            <button type="button" class="btn btn-sm btn-bg btn-default" ng-click="onNextPage()"
                                    ng-disabled="paginationOptions.numberOfPages >= paginationOptions.countOfPages">
                                <i class="fa fa-chevron-right"></i>
                            </button>
                           
                        </div>

                       <div class="btn-toolbar" style="padding-left: 2px">
							<div class="btn-group">
                                <button id="dateranger" class="btn btn-sm btn-icon btn-default" data-toggle="tooltip" title="Filter" data-placement="bottom" ui-jq="daterangepicker" ui-options="dateRangeOption"	 data-title="Refresh" ng-click="onClickDateFilter()">
                                    <i class="fa fa-calendar"></i>
                                </button>		
					  
                                <button class="btn btn-sm btn-icon btn-default" data-toggle="tooltip" title="Refresh" data-placement="bottom" ng-click="refreshTickets()">
                                    <i class="fa fa-refresh"></i>
                                </button>
                                <button class="btn btn-sm btn-icon btn-default" data-toggle="tooltip" title="Filter" data-placement="bottom" 
                                uib-popover-template="'filter_template.html'" popover-placement="bottom-left">
                                <i class="fa fa-filter" ng-style="{'color': filter_apply ? '#23b7e5' : '#58666e'}"></i>
                            </button>
							  					
					        </div>
					<!--
                            <div class="btn-group dropdown">
                                <button class="btn btn-sm btn-default" data-toggle="dropdown" aria-expanded="false" ng-hide="complaint.status == 2">
                                    <span class="caret"></span>
                                </button>
                                <ul class="dropdown-menu w1" aria-labelledby="single-button">
                                    <li ng-click="onFilter('Total')">
                                        <a href=""><label>ALL</label></a>
                                    </li>
                                    <li ng-click="onFilter(1)">
                                        <a href=""><label>Pending</label></a>
                                    </li>
                                    <li ng-click="onFilter(2)">
                                        <a href=""><label>In-Progress</label></a>
                                    </li>
                                    <li ng-click="onFilter(3)">
                                    <a href=""><label>Resolved</label></a>
                                    </li>
                                    <li ng-click="onFilter(4)">
                                        <a href=""><label>Re-opened</label></a>
                                    </li>
                                    <li ng-click="onFilter(5)">
                                        <a href=""><label>Closed</label></a>
                                    </li>
                                    <li ng-click="onFilter(6)">
                                        <a href=""><label>Rejected</label></a>
                                    </li>
                                    <li ng-click="onFilter(7)">
                                        <a href=""><label>Awaiting Approval</label></a>
                                    </li>
                                    <li ng-click="onFilter(8)">
                                        <a href=""><label>Awaiting Approval 2</label></a>
                                    </li>
                                    <li ng-click="onFilter(9)">
                                        <a href=""><label>Awaiting Approval 3</label></a>
                                    </li>
                                </ul>
                            </div>
                            <div class="btn-group dropdown" style="margin-top:-1px">
                                <button class="btn btn-default">&nbsp;{{selected_building.name}}&nbsp;</button>
                                <button class="btn btn-default" data-toggle="dropdown" aria-expanded="false"><span class="caret"></span></button>
                                <ul class="dropdown-menu w1" aria-labelledby="single-button">
                                    <li ng-repeat="row in building_list" ng-click="onBuildingFilter(row)">
                                        <a href=""><label>{{row.name}}</label></a>
                                    </li>                                    
                                </ul>
                            </div>    

                        -->
                            
                            <div class="btn-group pull-right" style="margin-right: 20px;margin-top: 5px;">
                                <a ng-click="onDownloadExcel()">
                                    <i class="fa fa-file-excel-o" style="font-size: 20px; color:green" aria-hidden="true" title="Summary Excel download"></i>
                                </a>
                            </div>
					
					
						</div>
                    </div>

                    <!-- / header -->

                    <!-- list -->
                    <ul id="list_ticket" class="list-group list-group-lg no-radius m-b-none m-t-n-xxs" style="{{detail_view_height}}">

                        <li ng-repeat="row in ticketlist" class="list-group-item  clearfix b-l-5x " ng-class="{'active': row.active}">
                            
                           <div class="clear" ng-click="onSelectTicket(row, $event, 1)">
                                <div class="clear">
                                    <label class="font-bold">
                                        {{getTicketNumber(row)}}</label>&nbsp;|
                                    <label>{{row.category}} </label>&nbsp;|
                                    <label>{{row.subject}} </label>
                                    <label class="pull-right font-bold"><a class="text-sm"><i class="fa fa-calendar text-primary"></i>
                                        &nbsp;{{row.created_at| mydatetime : 'D MMM YYYY hh:mm a'}}</a></label>
                                </div>

                                <div class="text-ellipsis text-sm clear" style=" width: 100%; margin: 0px">
                                    &nbsp;
                                    <i ng-show = "row.sev" class="fa fa-user-circle" style = "color:#1565C0;"></i> &nbsp; {{row.firstname}} &nbsp;{{row.lastname}}&nbsp;| &nbsp;<i ng-show = "row.department" class="fa fa-building" style = "color:#00796B;"></i>&nbsp; {{row.department}} &nbsp; | &nbsp;
                                    <i ng-show = "row.sev" class="fa fa-exclamation-triangle text-danger" ng-if="row.sev == 'Serious'"></i>
                                    <i ng-show = "row.sev" class="fa fa-info-circle text-info"  ng-if="row.sev == 'Informational'"></i>
                                    <i ng-show = "row.sev" class="fa fa-exclamation-circle text-primary"  ng-if="row.sev == 'Minor'"></i>
                                    <i ng-show = "row.sev" class="fa fa-exclamation-circle text-danger"  ng-if="row.sev == 'Major'"></i>
                                    <i ng-show = "row.sev" class="fa fa-exclamation-circle text-warning-dker" ng-if="row.sev == 'Moderate'"></i>
                                        &nbsp;{{::row.sev}}&nbsp;	
                                    <div class="pull-right" style="margin-right: 6px; margin-top: -1px">
                                         <span ng-class="{'label' : true, 'm-l-sm': true,
                                          'bg-wakeup-pending ': row.status == 'Pending',
                                          'bg-wakeup-success': row.status == 'In-Progress',
                                          'bg-all': row.status == 'Resolved',
                                          'bg-complaint-ack': row.status == 'Re-Opened',
                                          'bg-wakeup-in-progress': row.status == 'Closed',
                                          'bg-wakeup-failed': row.status == 'Rejected',
                                          'bg-wakeup-waiting': row.status == 'On-Hold',
                                          'bg-wakeup-busy': row.status == 'Awaiting Approval',
                                          'grey': row.status == 'Awaiting Approval 2',
                                          'blue': row.status == 'Awaiting Approval 3'
                                            }">
                                            {{row.status}}                                                
                                         </span>
                                    </div>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
                <div class="col">
                    <div class="wrapper bg-light lter b-b" style="text-align: center">
                        <a class="btn btn-sm w-xs font-bold"  ng-show="select_status[1]" disabled>{{getTicketNumber(selectedTicket[0])}}</a>
                        <a class="btn btn-sm w-xs font-bold" ng-show="select_status[0]" disabled>New Request</a>
                        <button type="button" class="col-sm-2 btn btn-sm m-b-xs w-xs btn-light text-success font-bold" style="background-color: white;border-color:rgb(238, 236, 236)" ng-click="onCreateNew()">
                            <span class="text-success">
                                <i class="fa fa-plus" aria-hidden="true"></i>&nbsp;Create
                            </span>
                        </button>
                        <!--
                        <button type = "button" class="col-sm-2 btn btn-sm m-b-xs w-xs btn-light text-success pull-right" style="background-color: white;border-color:rgb(238, 236, 236)" ng-click="editRequestor()" ng-if="auth_svc.isValidModule('app.mytask.it_category_add')" >
                            <span class="text-success"> 
                                <i class="fa fa-pencil-square text-success" style="cursor: pointer" title="Edit Requestor Details"   aria-hidden="true"></i>
                                </span>
                        </button>
                    -->
                        <div class= 'pull-right'>
                        <span ng-click="editRequestor()" ><i class="fa fa-pencil-square fa-2x text-success" style="cursor: pointer" title="Edit Requestor Details"   aria-hidden="true"></i>&nbsp;</span>
                        </div>
                    </div>
       
                    <div  style="{{detail_view_height}} padding: 15px">
                        <div  ng-show="select_status[1]" ng-if="select_status[1] == true" class="stretch" style=""  ng-include="'tpl/it/issue_edit.html'" ng-controller="IssueEditController" >
                        </div>
                        <div ng-show="select_status[0]" ng-if="select_status[0] == true" class="stretch" style="height:100%" ng-include="'tpl/it/issue_create.html'" ng-controller="IssueCreateController">
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>
    </div>
</div>